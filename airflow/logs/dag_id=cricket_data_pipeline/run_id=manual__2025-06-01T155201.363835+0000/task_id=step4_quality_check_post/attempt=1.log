[2025-06-01T17:52:33.336+0200] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: cricket_data_pipeline.step4_quality_check_post manual__2025-06-01T15:52:01.363835+00:00 [queued]>
[2025-06-01T17:52:33.339+0200] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: cricket_data_pipeline.step4_quality_check_post manual__2025-06-01T15:52:01.363835+00:00 [queued]>
[2025-06-01T17:52:33.340+0200] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2025-06-01T17:52:33.349+0200] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): step4_quality_check_post> on 2025-06-01 15:52:01.363835+00:00
[2025-06-01T17:52:33.353+0200] {standard_task_runner.py:57} INFO - Started process 26992 to run task
[2025-06-01T17:52:33.355+0200] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'cricket_data_pipeline', 'step4_quality_check_post', 'manual__2025-06-01T15:52:01.363835+00:00', '--job-id', '24', '--raw', '--subdir', 'DAGS_FOLDER/cricket_pipeline_dag.py', '--cfg-path', '/tmp/tmpxud77puo']
[2025-06-01T17:52:33.356+0200] {standard_task_runner.py:85} INFO - Job 24: Subtask step4_quality_check_post
[2025-06-01T17:52:33.382+0200] {task_command.py:416} INFO - Running <TaskInstance: cricket_data_pipeline.step4_quality_check_post manual__2025-06-01T15:52:01.363835+00:00 [running]> on host Ashwa.
[2025-06-01T17:52:33.418+0200] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='lohit' AIRFLOW_CTX_DAG_ID='cricket_data_pipeline' AIRFLOW_CTX_TASK_ID='step4_quality_check_post' AIRFLOW_CTX_EXECUTION_DATE='2025-06-01T15:52:01.363835+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-01T15:52:01.363835+00:00'
[2025-06-01T17:52:33.505+0200] {logging_mixin.py:154} INFO - Starting post-wrangling quality assessment...
[2025-06-01T17:52:33.530+0200] {logging_mixin.py:154} INFO - Found tables: ['deliveries', 'innings', 'matches', 'overs', 'players']
[2025-06-01T17:52:33.534+0200] {logging_mixin.py:154} INFO - Table deliveries: 929433 rows, 23 columns
[2025-06-01T17:52:33.540+0200] {logging_mixin.py:154} INFO - Table innings: 8235 rows, 7 columns
[2025-06-01T17:52:33.545+0200] {logging_mixin.py:154} INFO - Table matches: 4110 rows, 21 columns
[2025-06-01T17:52:33.548+0200] {logging_mixin.py:154} INFO - Table overs: 148895 rows, 11 columns
[2025-06-01T17:52:33.551+0200] {logging_mixin.py:154} INFO - Table players: 7059 rows, 4 columns
[2025-06-01T17:52:33.551+0200] {logging_mixin.py:154} INFO - Analyzing column ranges...
[2025-06-01T17:52:33.564+0200] {logging_mixin.py:154} INFO - Analyzed 13 columns
[2025-06-01T17:52:33.564+0200] {logging_mixin.py:154} INFO - Applying type conversions...
[2025-06-01T17:52:34.073+0200] {logging_mixin.py:154} INFO - Converted table: deliveries
[2025-06-01T17:52:34.087+0200] {logging_mixin.py:154} INFO - Converted table: innings
[2025-06-01T17:52:34.106+0200] {logging_mixin.py:154} INFO - Converted table: matches
[2025-06-01T17:52:34.198+0200] {logging_mixin.py:154} INFO - Converted table: overs
[2025-06-01T17:52:34.199+0200] {logging_mixin.py:154} INFO - Applied 15 type conversions
[2025-06-01T17:52:34.199+0200] {logging_mixin.py:154} INFO - Analyzing NULL values...
[2025-06-01T17:52:34.239+0200] {logging_mixin.py:154} INFO - Table deliveries: 6 columns have NULL values
[2025-06-01T17:52:34.240+0200] {logging_mixin.py:154} INFO - Table innings: 2 columns have NULL values
[2025-06-01T17:52:34.240+0200] {logging_mixin.py:154} INFO - Table matches: 10 columns have NULL values
[2025-06-01T17:52:34.240+0200] {logging_mixin.py:154} INFO - Table players: 1 columns have NULL values
[2025-06-01T17:52:34.240+0200] {logging_mixin.py:154} INFO - Performing cricket-specific validation...
[2025-06-01T17:52:34.260+0200] {logging_mixin.py:154} INFO - Validation results:
[2025-06-01T17:52:34.260+0200] {logging_mixin.py:154} INFO - - invalid_batter_runs: 0
[2025-06-01T17:52:34.260+0200] {logging_mixin.py:154} INFO - - seven_run_deliveries: {'count': 2, 'percentage': 0.00021518495685003653}
[2025-06-01T17:52:34.261+0200] {logging_mixin.py:154} INFO - - matches_exceeded_overs: 0
[2025-06-01T17:52:34.261+0200] {logging_mixin.py:154} INFO - - over_length_distribution: {1: 468, 2: 509, 3: 567, 4: 595, 5: 621, 6: 113078, 7: 25377, 8: 5580, 9: 1439, 10: 417, 11: 140, 12: 53, 13: 28, 14: 8, 15: 6, 16: 6, 17: 1, 19: 2}
[2025-06-01T17:52:34.261+0200] {logging_mixin.py:154} INFO - Checking player consistency...
[2025-06-01T17:52:34.298+0200] {logging_mixin.py:154} INFO - Player consistency results:
[2025-06-01T17:52:34.299+0200] {logging_mixin.py:154} INFO - - players_missing_ids: 15
[2025-06-01T17:52:34.299+0200] {logging_mixin.py:154} INFO - - players_with_multiple_ids: 52
[2025-06-01T17:52:34.299+0200] {logging_mixin.py:154} INFO - - synthetic_player_ids: 0
[2025-06-01T17:52:34.303+0200] {logging_mixin.py:154} INFO - 
Summary Report:
[2025-06-01T17:52:34.303+0200] {logging_mixin.py:154} INFO - - Total matches: 4110
[2025-06-01T17:52:34.303+0200] {logging_mixin.py:154} INFO - - Total players: 7059
[2025-06-01T17:52:34.303+0200] {logging_mixin.py:154} INFO - - Total deliveries: 929433
[2025-06-01T17:52:34.303+0200] {logging_mixin.py:154} INFO - - Date range: 2005-02-17 to 2025-04-26
[2025-06-01T17:52:34.303+0200] {logging_mixin.py:154} INFO - - Match types: 1
[2025-06-01T17:52:34.303+0200] {logging_mixin.py:154} INFO - Summary saved to /home/lohit/airflow/data/quality_assessment_summary.txt
[2025-06-01T17:52:34.356+0200] {python.py:194} INFO - Done. Returned value was: Step 4 completed: {'status': 'success', 'tables_processed': 5, 'conversions_applied': 15, 'summary': {'matches_count': 4110, 'players_count': 7059, 'innings_count': 8235, 'overs_count': 148895, 'deliveries_count': 929433, 'match_types': {'T20': 4110}, 'date_range': {'earliest': '2005-02-17', 'latest': '2025-04-26'}}}
[2025-06-01T17:52:34.367+0200] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=cricket_data_pipeline, task_id=step4_quality_check_post, execution_date=20250601T155201, start_date=20250601T155233, end_date=20250601T155234
[2025-06-01T17:52:34.410+0200] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-06-01T17:52:34.419+0200] {taskinstance.py:2778} INFO - 1 downstream tasks scheduled from follow-on schedule check
